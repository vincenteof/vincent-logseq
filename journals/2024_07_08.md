- [[Crypto Roadmap]] [[pancakeswap]] lottery
	- https://docs.pancakeswap.finance/products/lottery
	- https://github.com/pancakeswap/pancake-smart-contracts/tree/master/projects/lottery
	- 核心方法
		- `function buyTickets(uint256 _lotteryId, uint32[] calldata _ticketNumbers)`
			- 首先计算买的奖券总计多少 cake 并划转到合约
			- 针对该用户买的奖券，对可能的中奖组合进行全局记数，用于最终计算该次抽奖发放多少 token
				- ```
				  _numberTicketsPerLotteryId[_lotteryId][1 + (thisTicketNumber % 10)]++;
				  _numberTicketsPerLotteryId[_lotteryId][11 + (thisTicketNumber % 100)]++;
				  _numberTicketsPerLotteryId[_lotteryId][111 + (thisTicketNumber % 1000)]++;
				  _numberTicketsPerLotteryId[_lotteryId][1111 + (thisTicketNumber % 10000)]++;
				  _numberTicketsPerLotteryId[_lotteryId][11111 + (thisTicketNumber % 100000)]++;
				  _numberTicketsPerLotteryId[_lotteryId][111111 + (thisTicketNumber % 1000000)]++;
				  ```
				- 如果直接用取余后的结果去做 key 会产生冲突，比如 1234507，最后一位和最后两位是一样的。转化以后 key 的范围不会冲突，比如最后一位的范围是 1 ～ 10， 最后两位的范围是 11 ～ 110，以此类推。
				- 这里没有检查 number 是否被取用，存在多个用户买了同一个 ticket number？
		- `function drawFinalNumberAndMakeLotteryClaimable(uint256 _lotteryId, bool _autoInjection)`
			- 产生中奖号码并计算所有参与者的总奖金数量
			-
		- `function claimTickets(uint256 _lotteryId,uint256[] calldata _ticketIds,uint32[] calldata _brackets)`
			- 中奖用户 claim 奖励
		-
		-