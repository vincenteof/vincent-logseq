- [[evm]] vs traditional operating system #[[Crypto Roadmap]]
	- https://tusharbhatia43.medium.com/ethereum-virtual-machine-evm-vs-traditional-operating-systems-a-simple-guide-part-1-6b0ec23ca8d1
- diving into [[ethereum]]'s world state
	- https://medium.com/cybermiles/diving-into-ethereums-world-state-c893102030ed
- a guid to [[ethereum]] [[gas]] #[[Crypto Roadmap]]
	- https://consensys.io/blog/a-guide-to-gas?ref=decipherclub.com
- [[foundry]] fundamentals #[[Crypto Roadmap]]
	- https://updraft.cyfrin.io/courses/foundry
	- create a new foundry project: `forge init`
	- compile：`forge compile`
	- 本地启动测试网：`anvil`
		- metamask 中 hardhat 的配置可以复用，因为链id 和 rpc url 是一样的
	- 大部分 rpc 需要实现以太坊的标准 http 调用方法
		- ethereum json rpc specification
	- 部署合约到 anvil：
		- `forge create Couter --interactive`
			- 这种方式更安全，因为不能用 history 看到
		- `forge create Counter --private-key 0x...`
		- 部署合约需要一个账户，这里需要把私钥提供出来
	- I promise to never use my private key associated with real money in plain text
	- 在 foundry 中部署一个合约也是用 solidity 写的，一般位于 `script/XXX.s.sol`
		- 需要引入 `forge-std` 里的 `Script` 进行继承
	- 通过 `forge script script/XXX.s.sol` 来部署一个合约，这里没有制定 rpc url，所以在执行命令的时候会自动启动一个 anvil
		- 通过 `--rpc-url  http://127.0.0.1:8545` 来对制定的链进行部署
		- 通过 `--broadcast --private-key 0x...` 来进行模拟真实的部署
			- 执行完以后会在 `broadcast` 文件夹下留下记录
	- foundry 提供了 `cast` 可以提供转换功能
		- `cast --to-base 0x21de9 dec`
	- 在 `broadcast` 里存储数据里有一个字段是 transaction，它就是我们实际发送给 RPC URL 的 api data
		- `from` 发出请求的地址
		- `gas` 这个 transaction 提供的 gas
		- `value` 转账金额，部署合约的时候也提供 ether
		- `data` 这里是合约的 opcode
		- `nonce` 每个客户端发出 transaction 的时候都会递增，这个用于防止重放攻击
		- 这里没有 signature，但是实际上发送时会用 private key 进行签名来证明身份
	- 也可以把 private key 和 rpc url 放在 .env 文件，然后 `source .env`，这样在执行 forge 命名的时候可以不用输入这些参数
		- 这种方案会比较危险，避免提交 env 文件，真实的 money 还是 interactive 比较好或则使用 keystore （foundry 目前在支持中）
		- 涉及真实的资金一定不能用 env
		- interactive 也要删除 history
		- 或者使用 keystore 的加密方案保管 pk
	- 现在 .env 的方案已不被推荐，永远不要用 plain text 存储 private key
		- ERC-2335
		- `cast wallet import defaultKey --interactive`
			- 把 private key 用密码保存下来
		- `forge script script/Counter.s.sol --rpc-url http://127.0.0.1:8545 --account defaultKey --sender 0xf39fd6e51aad88f6f4ce6ab8827279cfffb92266  --broadcast`
			- 这里部署需要输入之前的密码
		- `cast wallet list`
			- 查看所有保存的 private key
			- 文件的具体位置在 `~/.foundry/keystores/`
	- 用 cli 交互合约（需要提供 private key）
		- `cast send`
			- 发送 transaction，针对改变区块链状态的方法
		- `case call`
			- 调用 view function
	- 部署 testnet 或 live net
		- alchemy 上建立应用后拿到 rpc url，如果你可以自建 node 就不需要
		- 然后只要在部署脚本中把对应的 rpc url 放进去就行
	- 在 etherscan 上手动验证合约
		- 选择地址点击 contract 后可以看到 bytecode，选择 verify 后可以把对应的合约代码粘贴进去，验证成功后就可以直接在 etherscan 上类似 remix 的交互了。这种方案繁琐而且容易出错。
	- zksync
		- foundry-zksync
		- 暂时跳过
	- alchemy
		- 可以看到失败的调用记录
		- mempool watcher
	- 合约测试
		- foundry 并没有用到 npm，因此安装第三方合约的时候可以直接用 github 的 repo 地址
			- `forge install someorg/somerepo@1.1.1 --no-commit`
		- 还需要在 toml 中配置 remapping 告诉 foundry 针对 npm 的引用路径指向哪里
			- `remappings = ["@chainlink/contracts/=lib/chainlink-brownie-contracts/contracts/"]`
		- 看安装之后的代码貌似用了 git submodules
	- 在 foundry 中实现 FundMe 并进行测试
		- test 与 script 的基本结构
		- 只运行某个特定的 test case
			- `forge test -m testXXX -vvv`
		- 基于 chain fork 进行测试
			- `forge test -m testXXX --fork-url $SEPOLIA_RPC_URL`
			- 这种方式会对 rpc 结点发出大量请求，所以可能会产生费用
			- rpc url 可以从 alchemy 获取
-