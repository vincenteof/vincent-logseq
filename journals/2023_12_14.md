- web3-from-scratch 技术思考
  id:: 6579d529-5754-495b-8530-4424c5e4dc54
	- hardhat 内部集成了 mocha，且对 ts 与 esm 的联合使用目前支持并不好，因为没有找到一个可以结合 vitest 去做合约测试的方案。
	- openzeppelin/contracts v5 对 solidity 的版本要求达到了 8.0.20，目前没有找到配置 hardhat 的方案，选择了降级到 4 的最新版本。
	- when does typechain files generated in hardhat
	- 在 solidity 中总是倾向于先乘后除，因为语言本身对浮点数支持不佳
	- 给定一个合约地址，去调用它的方法，可以手动定义 interface 转换后完成
	- hardhat 在使用 typechain 生成类型时，默认 import 了很多自己的依赖，而在 pnpm 的项目中这些依赖被隔离了，需要手动在 devDependencies 里添加
	- 可以在 GOERLI 网络获取测试代币以后进行 dapp 测试
	- WalletConnect Cloud projectId 是什么？为何 dapp 或者说 wallet connect 需要它，这好像是一个很中心化的东西
	- 如何 loop 一个 solidity mapping，尝试直接用前端连接合约，很多数据都很难计算，使用数据库去同步 event 是个解决方案
	- getSigners 的作用
	- 在 hardhat 测试网络如何使用 ethscan
	- 在 off-chain 的环境下，调用完合约以后的返回值无法直接拿到, 解决方案：
		- 创建对应 view function
		- emit event，通过 event 查询
		- callStatic，但是貌似在新版的 etherjs 不行?
	- getSigners, xxx.connect...
	- hardhat 测试环境也存在 gas fee，gas fee 计算
	- 虽然 ethers 里存在各种不同的 provider, 但是只要提供的是 json rpc url，都可以用 JsonRpcProvider
	- 需要确保 tokenAddress 是合法的 ERC20 地址，一种是动态检察，这种方案会在 create 产生更多 gas 消耗。另一种方案是链下的 whitelisting。如果不检查但用了非法的 token 地址可能会产生啥。
	- hardhat 可以直接在配置文件中用私钥设置余额，也可以手动执行脚本 setBalance
	- etherjs 连 hardhat 的时候监听事件报错
		- https://github.com/ethers-io/ethers.js/issues/2338#issuecomment-1943245132
		-
	- 针对 hardhat 的 block explorer
		- https://github.com/tryethernal/hardhat-ethernal
		- https://app.tryethernal.com/overview
		- 勉强够用，自己需要 decode event
	- indexer 相关：
		- https://www.reddit.com/r/ethdev/comments/14z1kav/what_is_the_best_way_to_handle_smart_contract/
		- https://gallery.mirror.xyz/CC926szCICnwa908S4r1B2hk_q-mTSjeQUUGnO1b6QI
		- https://medium.com/coinmonks/ethereum-event-indexer-55013c3623ae
		- {{video https://www.youtube.com/watch?v=4akZVr3FuWg}}
	- todo:
		- hardhat etherscan remix，easy to create test data
		- 合约 test cases
		- 前端获取 abi 及 contract address 的优雅方式，基于 menorepo
		- 更简单的合约部署方式，去除 hardhat deploy 插件
		- 关键操作 emit 事件
		- 在前端需要查询链上数据，对于复杂行为需要聚合之类，需要引入类似 the graph
		- contract-abi, 如何自动化
		- 本地各种合约代码与前端代码的字段自动化同步
		- 前端 createExchange
		- indexer 存入数据库
		- indexer 性能问题
-